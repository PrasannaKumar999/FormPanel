<div class="home-container">
  <mat-toolbar color="primary" class="toolbar">
    <span class="title">SmartForm Portal</span>
    <span class="spacer"></span>
    <span class="user">Welcome, {{ username }}</span>
    <button mat-button (click)="onLogout()">Logout</button>
  </mat-toolbar>

  <mat-card class="form-card">
    <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="form-grid">
      <!-- Name and Mobile -->
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Mobile No</mat-label>
          <input matInput formControlName="mobile" />
        </mat-form-field>
      </div>

      <!-- Address -->
      <mat-form-field appearance="outline" class="form-field full-width">
        <mat-label>Address</mat-label>
        <textarea matInput rows="2" formControlName="address"></textarea>
      </mat-form-field>

      <!-- Skills and Hobbies -->
      <div class="form-row">
        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Skills</mat-label>
          <input matInput formControlName="skills" />
        </mat-form-field>

        <mat-form-field appearance="outline" class="form-field">
          <mat-label>Hobbies</mat-label>
          <input matInput formControlName="hobbies" />
        </mat-form-field>
      </div>

      <!-- Photo Upload -->
      <div class="form-field full-width">
        <label class="file-label">Upload Photo or PDF</label>
        <input
          type="file"
          accept="image/*,application/pdf"
          (change)="onFileChange($event)"
        />
        <img *ngIf="photoPreview" [src]="photoPreview" class="preview" />
      </div>

      <div class="submit-btn">
        <button mat-flat-button color="primary" type="submit">Submit</button>
      </div>
    </form>
  </mat-card>

  <!-- Table of submitted data -->
  <mat-card *ngIf="submittedData.length" class="table-card">
    <table mat-table [dataSource]="submittedData" class="mat-elevation-z8">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let el">{{ el.name }}</td>
      </ng-container>

      <ng-container matColumnDef="mobile">
        <th mat-header-cell *matHeaderCellDef>Mobile</th>
        <td mat-cell *matCellDef="let el">{{ el.mobile }}</td>
      </ng-container>

      <ng-container matColumnDef="skills">
        <th mat-header-cell *matHeaderCellDef>Skills</th>
        <td mat-cell *matCellDef="let el">{{ el.skills }}</td>
      </ng-container>

      <ng-container matColumnDef="hobbies">
        <th mat-header-cell *matHeaderCellDef>Hobbies</th>
        <td mat-cell *matCellDef="let el">{{ el.hobbies }}</td>
      </ng-container>

      <ng-container matColumnDef="photoName">
        <th mat-header-cell *matHeaderCellDef>Photo</th>
        <td mat-cell *matCellDef="let el">
          <img
            *ngIf="el?.photo"
            [src]="'http://localhost:5000/uploads/' + el.photo"
            alt="photo"
            class="table-photo"
          />
        </td>
      </ng-container>

      <tr
        mat-header-row
        *matHeaderRowDef="['name', 'mobile', 'skills', 'hobbies', 'photoName']"
      ></tr>
      <tr
        mat-row
        *matRowDef="
          let row;
          columns: ['name', 'mobile', 'skills', 'hobbies', 'photoName']
        "
      ></tr>
    </table>
    <div class="export-btn">
      <button mat-stroked-button color="primary" (click)="exportToExcel()">
        Download Excel
      </button>
    </div>
  </mat-card>
</div>
